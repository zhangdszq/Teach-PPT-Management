// 教材相关的Mock数据
import type { Textbook } from '../types'

/**
 * 教材Mock数据
 */
export const mockTextbooks: Textbook[] = [
  {
    id: '1',
    title: '小学英语一年级上册',
    subject: '英语',
    grade: '1年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/3B82F6/white?text=英语一年级上',
    workspaceId: '1',
    pptCount: 8
  },
  {
    id: '2',
    title: '小学英语一年级下册',
    subject: '英语',
    grade: '1年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/10B981/white?text=英语一年级下',
    workspaceId: '1',
    pptCount: 8
  },
  {
    id: '3',
    title: '小学英语二年级上册',
    subject: '英语',
    grade: '2年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/8B5CF6/white?text=英语二年级上',
    workspaceId: '1',
    pptCount: 10
  },
  {
    id: '4',
    title: '小学英语二年级下册',
    subject: '英语',
    grade: '2年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/F59E0B/white?text=英语二年级下',
    workspaceId: '1',
    pptCount: 10
  },
  {
    id: '5',
    title: '小学英语三年级上册',
    subject: '英语',
    grade: '3年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/EF4444/white?text=英语三年级上',
    workspaceId: '1',
    pptCount: 12
  },
  {
    id: '6',
    title: '小学英语三年级下册',
    subject: '英语',
    grade: '3年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/6366F1/white?text=英语三年级下',
    workspaceId: '1',
    pptCount: 12
  },
  {
    id: '7',
    title: '小学英语四年级上册',
    subject: '英语',
    grade: '4年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/EC4899/white?text=英语四年级上',
    workspaceId: '1',
    pptCount: 14
  },
  {
    id: '8',
    title: '小学英语四年级下册',
    subject: '英语',
    grade: '4年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/14B8A6/white?text=英语四年级下',
    workspaceId: '1',
    pptCount: 14
  },
  {
    id: '9',
    title: '小学英语五年级上册',
    subject: '英语',
    grade: '5年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/84CC16/white?text=英语五年级上',
    workspaceId: '1',
    pptCount: 16
  },
  {
    id: '10',
    title: '小学英语五年级下册',
    subject: '英语',
    grade: '5年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/06B6D4/white?text=英语五年级下',
    workspaceId: '1',
    pptCount: 16
  },
  {
    id: '11',
    title: '小学英语六年级上册',
    subject: '英语',
    grade: '6年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/8B5CF6/white?text=英语六年级上',
    workspaceId: '1',
    pptCount: 18
  },
  {
    id: '12',
    title: '小学英语六年级下册',
    subject: '英语',
    grade: '6年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/F97316/white?text=英语六年级下',
    workspaceId: '1',
    pptCount: 18
  },
  {
    id: '13',
    title: '初中英语七年级上册',
    subject: '英语',
    grade: '初一',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/EF4444/white?text=英语七年级上',
    workspaceId: '1',
    pptCount: 20
  },
  {
    id: '14',
    title: '初中英语七年级下册',
    subject: '英语',
    grade: '初一',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/10B981/white?text=英语七年级下',
    workspaceId: '1',
    pptCount: 20
  },
  {
    id: '15',
    title: '初中英语八年级上册',
    subject: '英语',
    grade: '初二',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/3B82F6/white?text=英语八年级上',
    workspaceId: '1',
    pptCount: 22
  },
  {
    id: '16',
    title: '初中英语八年级下册',
    subject: '英语',
    grade: '初二',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/10B981/white?text=英语八年级下',
    workspaceId: '1',
    pptCount: 22
  },
  {
    id: '17',
    title: '初中英语九年级上册',
    subject: '英语',
    grade: '初三',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/EC4899/white?text=英语九年级上',
    workspaceId: '1',
    pptCount: 24
  },
  {
    id: '18',
    title: '初中英语九年级下册',
    subject: '英语',
    grade: '初三',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/F59E0B/white?text=英语九年级下',
    workspaceId: '1',
    pptCount: 24
  },
  // 数学教材
  {
    id: '19',
    title: '小学数学一年级上册',
    subject: '数学',
    grade: '1年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/F59E0B/white?text=数学一年级上',
    workspaceId: '2',
    pptCount: 10
  },
  {
    id: '20',
    title: '小学数学一年级下册',
    subject: '数学',
    grade: '1年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/8B5CF6/white?text=数学一年级下',
    workspaceId: '2',
    pptCount: 10
  },
  // 语文教材
  {
    id: '21',
    title: '小学语文一年级上册',
    subject: '语文',
    grade: '1年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/10B981/white?text=语文一年级上',
    workspaceId: '3',
    pptCount: 12
  },
  {
    id: '22',
    title: '小学语文一年级下册',
    subject: '语文',
    grade: '1年级',
    publisher: '人民教育出版社',
    coverImage: 'https://via.placeholder.com/200x280/EC4899/white?text=语文一年级下',
    workspaceId: '3',
    pptCount: 12
  }
]

/**
 * 教材相关的API方法
 */
export class TextbookAPI {
  private textbooks: Textbook[] = [...mockTextbooks]

  /**
   * 根据工作空间获取教材
   */
  async getTextbooksByWorkspace(workspaceId: string): Promise<Textbook[]> {
    await new Promise(resolve => setTimeout(resolve, 100))
    return this.textbooks.filter(t => t.workspaceId === workspaceId)
  }

  /**
   * 根据ID获取教材
   */
  async getTextbookById(id: string): Promise<Textbook | null> {
    await new Promise(resolve => setTimeout(resolve, 100))
    return this.textbooks.find(t => t.id === id) || null
  }

  /**
   * 创建教材
   */
  async createTextbook(textbook: Omit<Textbook, 'id'>): Promise<Textbook> {
    await new Promise(resolve => setTimeout(resolve, 200))
    const newTextbook: Textbook = {
      ...textbook,
      id: Date.now().toString()
    }
    this.textbooks.push(newTextbook)
    return newTextbook
  }

  /**
   * 更新教材
   */
  async updateTextbook(id: string, updates: Partial<Textbook>): Promise<Textbook | null> {
    await new Promise(resolve => setTimeout(resolve, 200))
    const index = this.textbooks.findIndex(t => t.id === id)
    if (index === -1) return null
    
    this.textbooks[index] = { ...this.textbooks[index], ...updates }
    return this.textbooks[index]
  }

  /**
   * 删除教材
   */
  async deleteTextbook(id: string): Promise<boolean> {
    await new Promise(resolve => setTimeout(resolve, 200))
    const index = this.textbooks.findIndex(t => t.id === id)
    if (index === -1) return false
    
    this.textbooks.splice(index, 1)
    return true
  }

  /**
   * 搜索教材
   */
  async searchTextbooks(query: string, workspaceId?: string): Promise<Textbook[]> {
    await new Promise(resolve => setTimeout(resolve, 100))
    let filtered = this.textbooks
    
    if (workspaceId) {
      filtered = filtered.filter(t => t.workspaceId === workspaceId)
    }
    
    if (query) {
      const lowerQuery = query.toLowerCase()
      filtered = filtered.filter(t => 
        t.title.toLowerCase().includes(lowerQuery) ||
        t.subject.toLowerCase().includes(lowerQuery) ||
        t.grade.toLowerCase().includes(lowerQuery) ||
        t.publisher.toLowerCase().includes(lowerQuery)
      )
    }
    
    return filtered
  }

  /**
   * 按学科获取教材
   */
  async getTextbooksBySubject(subject: string, workspaceId?: string): Promise<Textbook[]> {
    await new Promise(resolve => setTimeout(resolve, 100))
    let filtered = this.textbooks.filter(t => t.subject === subject)
    
    if (workspaceId) {
      filtered = filtered.filter(t => t.workspaceId === workspaceId)
    }
    
    return filtered
  }

  /**
   * 按年级获取教材
   */
  async getTextbooksByGrade(grade: string, workspaceId?: string): Promise<Textbook[]> {
    await new Promise(resolve => setTimeout(resolve, 100))
    let filtered = this.textbooks.filter(t => t.grade === grade)
    
    if (workspaceId) {
      filtered = filtered.filter(t => t.workspaceId === workspaceId)
    }
    
    return filtered
  }
}

// 导出单例实例
export const textbookAPI = new TextbookAPI()